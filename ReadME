# MP4 to PNG 处理引擎 v5.0

这是一个Python命令行工具，旨在将 MP4 视频文件转换为高质量的 PNG 图片序列。它不仅仅是一个简单的提取器，更是一个模块化的图像处理流水线，允许用户对输出的每一帧进行精细的尺寸缩放、艺术化效果加工以及画布合成。

本工具通过一个清晰的交互式命令行界面（CLI）进行操作，让复杂的多阶段处理流程变得井井有条、易于掌控。

## ✨ 主要功能

- **模块化处理流程**: 采用“提取 -> 缩放 -> 加工 -> 合成”的四阶段流水线，每一步都可独立配置或跳过。
- **高级缩放选项**: 内置五种专业的缩放模式，包括等比缩放、按百分比缩放，以及独特的“基于一个维度进行等比缩放，并限制另一个维度的最大值”功能。
- **专业的图像加工**:
  - **平滑边缘虚化**: 采用“缓入缓出”非线性渐变算法，实现极其平滑自然的边缘过渡。
  - **可配置效果顺序**: 支持两种不同的效果叠加引擎（“标准柔和”与“轮廓感”），以实现不同的艺术风格。
  - **独立参数控制**: 圆角、虚化、模糊三个核心效果的参数完全独立，可任意组合。
- **灵活的画布合成**: 可将处理后的图像居中合成到指定尺寸和颜色的画布上，支持设置背景透明度。
- **友好的交互体验**:
  - 工作流驱动的交互，从选择文件开始，引导用户完成配置。
  - 在配置界面实时计算并预览缩放后的尺寸。
  - 支持对单帧进行完整流程的快速预览，并自动打开预览图。
  - 在处理过程中提供实时进度条。

## ⚙️ 环境要求

1.  **Python**: 版本 `3.8` 或更高。
2.  **FFmpeg**: 这是一个**外部程序**，必须预先在您的操作系统中安装好，并确保其路径已添加到系统环境变量中。脚本会自动检测 FFmpeg 是否可用。
    -   您可以从 [FFmpeg官网](https://ffmpeg.org/download.html) 获取适合您操作系统的版本。
    -   对于 macOS 用户，推荐使用 [Homebrew](https://brew.sh/) 安装: `brew install ffmpeg`

## 🚀 安装与设置

1.  **克隆或下载仓库**:
    ```bash
    git clone [您的仓库URL]
    cd [您的项目文件夹]
    ```

2.  **安装Python依赖库**:
    项目使用 `Pillow` 和 `rich` 库。我们推荐使用 `requirements.txt` 文件进行安装，这会自动处理所有依赖。
    ```bash
    pip install -r requirements.txt
    ```

## ▶️ 如何使用

1.  **启动脚本**:
    在您的终端中，运行以下命令：
    ```bash
    python your_script_name.py
    ```
    *(请将 `your_script_name.py` 替换为您保存的实际文件名)*

2.  **初始设置**:
    -   脚本会首先提示您将**视频文件**拖入终端窗口，然后按回车。
    -   接着，会提示您输入**输出文件夹**的路径。如果直接回车，它将在源视频旁边创建一个同名文件夹作为输出目录。

3.  **交互式配置**:
    -   进入主配置菜单后，您会看到所有可用的配置模块和参数。
    -   根据提示，输入**数字编号**来修改对应的配置项。
    -   对于**缩放设置**（选项5），输入后会进入一个专门的子菜单，您可以在其中切换缩放模式（输入A-E）或修改各模式的参数（输入S1-S5）。

4.  **执行操作**:
    在配置菜单的底部，输入对应的字母执行操作：
    -   `S`: **开始**执行完整的处理流程。
    -   `P`: 生成并打开一个**预览**图，以检查当前设置的效果。
    -   `R`: **重置**所有配置到初始默认状态。
    -   `Q`: **退出**程序。

## 🛠️ 配置模块详解

#### 模块1: 图片帧提取
- **帧率 (FPS)**: 每秒从视频中提取的图片数量。

#### 模块2: 图片剪裁与缩放
- **启用缩放**: 是否对图片进行尺寸调整。
- **缩放模式**:
  - **A. 基于宽**: 将宽度缩放到指定值，高度等比缩放。
  - **B. 基于高**: 将高度缩放到指定值，宽度等比缩放。
  - **C. 基于宽-限最大高**: 在“基于宽”的基础上，如果计算出的高度超过限制，则会再次缩放以确保不超过最大高度。
  - **D. 基于高-限最大宽**: 与C模式相反。
  - **E. 按原始比例缩放**: 将宽高同时乘以一个百分比。

#### 模块3: 图片加工
- **启用图片加工**: 是否应用艺术化效果。
-
